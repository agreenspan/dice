{"version":3,"file":"browser.es5.es.js","sources":["../src/constants.js","../src/prepared.js","../src/dispatched.js","../src/utils/isReactCompositeComponent.js","../src/prepare.js","../src/split.js","../src/traverse-exclude.js","../src/prepare-provider.js","../src/middleware.js","../src/index.js"],"sourcesContent":["/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nexport const REACT_PREPARE = '@__REACT_PREPARE__@';\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport React, {Component} from 'react';\n\nimport {REACT_PREPARE} from './constants';\n\n// $FlowFixMe\nconst prepared = (prepare, opts = {}) => OriginalComponent => {\n  opts = Object.assign(\n    {\n      boundary: false,\n      defer: false,\n      componentDidMount: true,\n      componentWillReceiveProps: false,\n      componentDidUpdate: false,\n      contextTypes: {},\n      forceUpdate: false,\n    },\n    opts\n  );\n  const prep = {\n    prepare: (...args) => Promise.resolve(prepare(...args)),\n    defer: opts.defer,\n  };\n  // Disable eslint for deprecated componentWillReceiveProps\n  // eslint-disable-next-line react/no-deprecated\n  class PreparedComponent extends Component<*, *> {\n    // $FlowFixMe\n    constructor(props, context) {\n      super(props, context);\n      // $FlowFixMe\n      this[REACT_PREPARE] = prep;\n    }\n    componentDidMount() {\n      if (opts.componentDidMount) {\n        Promise.resolve(prepare(this.props, this.context)).then(() => {\n          if (opts.forceUpdate) {\n            this.forceUpdate(); // TODO(#10) document\n          }\n        });\n      }\n    }\n\n    // $FlowFixMe\n    componentWillReceiveProps(nextProps, nextContext) {\n      if (opts.componentWillReceiveProps) {\n        prepare(nextProps, nextContext);\n      }\n    }\n\n    componentDidUpdate() {\n      if (opts.componentDidUpdate) {\n        prepare(this.props, this.context);\n      }\n    }\n\n    render() {\n      return <OriginalComponent {...this.props} />;\n    }\n  }\n\n  const displayName =\n    OriginalComponent.displayName || OriginalComponent.name || '';\n  PreparedComponent.contextTypes = opts.contextTypes;\n  PreparedComponent.displayName = `PreparedComponent(${displayName})`;\n\n  return PreparedComponent;\n};\n\n// $FlowFixMe\nfunction isPrepared(CustomComponent) {\n  return (\n    CustomComponent[REACT_PREPARE] &&\n    typeof CustomComponent[REACT_PREPARE].prepare === 'function'\n  );\n}\n\n// $FlowFixMe\nfunction getPrepare(CustomComponent) {\n  return CustomComponent[REACT_PREPARE] || {};\n}\n\nexport {isPrepared, getPrepare};\nexport default prepared;\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport PropTypes from 'prop-types';\n\nimport prepared from './prepared';\n\nconst storeShape = PropTypes.shape({\n  dispatch: PropTypes.func.isRequired,\n});\n\n// $FlowFixMe\nconst dispatched = (prepareUsingDispatch, opts = {}) => OriginalComponent => {\n  const prepare = (props, context) => {\n    return prepareUsingDispatch(props, context.store.dispatch);\n  };\n  const contextTypes = Object.assign(\n    {},\n    opts && opts.contextTypes ? opts.contextTypes : {},\n    {store: storeShape}\n  );\n  const preparedOpts = Object.assign({}, opts, {contextTypes});\n  return prepared(prepare, preparedOpts)(OriginalComponent);\n};\n\nexport default dispatched;\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nexport default function isReactCompositeComponent(type: mixed) {\n  if (typeof type !== 'function') {\n    return false;\n  }\n  if (typeof type.prototype !== 'object') {\n    return false;\n  }\n  if (typeof type.prototype.render !== 'function') {\n    return false;\n  }\n  return true;\n}\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport React from 'react';\nimport {isFragment, isContextConsumer, isContextProvider} from 'react-is';\n\nimport isReactCompositeComponent from './utils/isReactCompositeComponent';\nimport {isPrepared, getPrepare} from './prepared';\n\nfunction renderCompositeElementInstance(instance) {\n  const childContext = Object.assign(\n    {},\n    instance.context,\n    instance.getChildContext ? instance.getChildContext() : {}\n  );\n  if (instance.componentWillMount) {\n    instance.componentWillMount();\n  }\n  const children = instance.render();\n  return [children, childContext];\n}\n\nfunction prepareComponentInstance(instance) {\n  if (!isPrepared(instance)) {\n    return Promise.resolve({});\n  }\n  const prepareConfig = getPrepare(instance);\n  // If the component is deferred, skip the prepare step\n  if (prepareConfig.defer) {\n    return Promise.resolve(prepareConfig);\n  }\n  // $FlowFixMe\n  return prepareConfig.prepare(instance.props, instance.context).then(() => {\n    return prepareConfig;\n  });\n}\n\nfunction prepareElement(element, context) {\n  if (element === null || typeof element !== 'object') {\n    return Promise.resolve([null, context]);\n  }\n  const {type, props} = element;\n  if (isContextConsumer(element)) {\n    return Promise.resolve([props.children(type._currentValue), context]);\n  }\n  if (isContextProvider(element)) {\n    type._context._currentValue = props.value;\n    return Promise.resolve([props.children, context]);\n  }\n  if (typeof type === 'string' || isFragment(element)) {\n    return Promise.resolve([props.children, context]);\n  }\n  if (!isReactCompositeComponent(type)) {\n    return Promise.resolve([type(props, context), context]);\n  }\n  const CompositeComponent = type;\n  const instance = new CompositeComponent(props, context);\n  instance.props = props;\n  instance.context = context;\n  return prepareComponentInstance(instance).then(prepareConfig => {\n    // Stop traversing if the component is defer or boundary\n    if (prepareConfig.defer || prepareConfig.boundary) {\n      return Promise.resolve([null, context]);\n    }\n    return renderCompositeElementInstance(instance);\n  });\n}\n\n// TODO(#4) We can optimize this algorithm I think\nfunction _prepare(element, context) {\n  return prepareElement(element, context).then(([children, childContext]) => {\n    return Promise.all(\n      React.Children.toArray(children).map(child =>\n        _prepare(child, childContext)\n      )\n    );\n  });\n}\n\nfunction prepare(element: any, context: any = {}) {\n  context.__IS_PREPARE__ = true;\n  return _prepare(element, context).then(() => {\n    context.__IS_PREPARE__ = false;\n  });\n}\n\nexport default prepare;\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport prepared from './prepared.js';\n\n// TODO(#6): Dry this up\nconst CHUNKS_KEY = '__CHUNK_IDS';\n\nconst contextTypes = {\n  splitComponentLoaders: PropTypes.array.isRequired,\n};\n\n// TODO(#7): Figure out what we are going to do with chunks/preloading\nif (__NODE__) {\n  // $FlowFixMe\n  contextTypes.preloadChunks = PropTypes.array.isRequired;\n}\n\n// $FlowFixMe\nexport default function withAsyncComponent({\n  defer,\n  load,\n  LoadingComponent,\n  ErrorComponent,\n}) {\n  let AsyncComponent = null;\n  let error = null;\n  let chunkIds = [];\n\n  function WithAsyncComponent(props) {\n    if (error) {\n      return <ErrorComponent error={error} />;\n    }\n    if (!AsyncComponent) {\n      return <LoadingComponent />;\n    }\n    return <AsyncComponent {...props} />;\n  }\n  return prepared(\n    (props, context) => {\n      if (AsyncComponent) {\n        if (__NODE__) {\n          chunkIds.forEach(chunkId => {\n            context.preloadChunks.push(chunkId);\n          });\n        }\n        return Promise.resolve(AsyncComponent);\n      }\n\n      let componentPromise;\n      try {\n        componentPromise = load();\n      } catch (e) {\n        componentPromise = Promise.reject(e);\n      }\n      // $FlowFixMe\n      chunkIds = componentPromise[CHUNKS_KEY] || [];\n\n      if (__NODE__) {\n        chunkIds.forEach(chunkId => {\n          context.preloadChunks.push(chunkId);\n        });\n      }\n\n      const loadPromises = [\n        componentPromise,\n        ...context.splitComponentLoaders.map(loader => loader(chunkIds)),\n      ];\n\n      return Promise.all(loadPromises)\n        .then(([asyncComponent]) => {\n          // TODO(#8) .default is toolchain specific, breaks w/ CommonJS exports\n          AsyncComponent = asyncComponent.default;\n        })\n        .catch(err => {\n          error = err;\n          if (__BROWSER__)\n            setTimeout(() => {\n              throw err;\n            }); // log error\n        });\n    },\n    {defer, contextTypes, forceUpdate: true}\n  )(WithAsyncComponent);\n}\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport prepared from './prepared.js';\n\n// Stops the traversal at this node. Useful for optimizing the prepare traversal\n// to visit the minimum number of nodes\nexport default prepared(Promise.resolve(), {\n  componentDidMount: false,\n  componentWillReceiveProps: false,\n  componentDidUpdate: false,\n  defer: true,\n});\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nclass PrepareProvider extends React.Component<*, *> {\n  constructor(props: any, context: any) {\n    super(props, context);\n    this.splitComponentLoaders = [];\n    this.preloadChunks = props.preloadChunks;\n  }\n\n  preloadChunks: any;\n  splitComponentLoaders: Array<any>;\n\n  getChildContext() {\n    return {\n      splitComponentLoaders: this.splitComponentLoaders,\n      preloadChunks: this.preloadChunks,\n    };\n  }\n  render() {\n    return React.Children.only(this.props.children);\n  }\n}\n\nPrepareProvider.childContextTypes = {\n  splitComponentLoaders: PropTypes.array.isRequired,\n  preloadChunks: PropTypes.array.isRequired,\n};\n\nexport default PrepareProvider;\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport React from 'react';\n\nimport type {Middleware} from 'fusion-core';\n\nimport PrepareProvider from './prepare-provider';\n\nconst middleware: Middleware = function(ctx, next) {\n  if (__NODE__ && !ctx.element) {\n    return next();\n  }\n  ctx.element = (\n    <PrepareProvider preloadChunks={ctx.preloadChunks}>\n      {ctx.element}\n    </PrepareProvider>\n  );\n  return next();\n};\n\nexport default middleware;\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport * as React from 'react';\n\nimport dispatched from './dispatched';\nimport prepare from './prepare';\nimport prepared from './prepared';\nimport split from './split';\nimport exclude from './traverse-exclude';\nimport middleware from './middleware'; //typed\n\nconst prepareTyped: (\n  element: React.Element<any>\n  // $FlowFixMe\n) => Promise<React.ComponentType<any>> = prepare;\n\nconst preparedTyped: (\n  sideEffect: (props: Object, context: Object) => Promise<any>,\n  opts?: {\n    defer?: boolean,\n    boundary?: boolean,\n    componentDidMount?: boolean,\n    componentWillReceiveProps?: boolean,\n    componentDidUpdate?: boolean,\n    forceUpdate?: boolean,\n    contextTypes?: Object,\n  }\n) => (\n  Component: React.ComponentType<any>\n) => React.ComponentType<any> = prepared;\n\nconst splitTyped: (opts: {\n  load: () => Promise<any>,\n  LoadingComponent: React.ComponentType<any>,\n  ErrorComponent: React.ComponentType<any>,\n}) => React.ComponentType<any> = split;\n\nconst excludeTyped: (\n  Component: React.ComponentType<any>\n) => React.ComponentType<any> = exclude;\n\n// TODO(#3): Can we get ride of some of these exports?\nexport {\n  dispatched,\n  prepareTyped as prepare,\n  preparedTyped as prepared,\n  splitTyped as split,\n  excludeTyped as exclude,\n  middleware,\n};\n"],"names":["REACT_PREPARE","prepared","prepare","opts","Object","assign","prep","Promise","resolve","defer","PreparedComponent","props","context","componentDidMount","then","forceUpdate","componentWillReceiveProps","nextProps","nextContext","componentDidUpdate","render","React","Component","displayName","OriginalComponent","name","contextTypes","isPrepared","CustomComponent","getPrepare","storeShape","PropTypes","shape","func","isRequired","dispatched","prepareUsingDispatch","store","dispatch","preparedOpts","isReactCompositeComponent","type","prototype","renderCompositeElementInstance","instance","childContext","getChildContext","componentWillMount","children","prepareComponentInstance","prepareConfig","prepareElement","element","_typeof","isContextConsumer","_currentValue","isContextProvider","_context","value","isFragment","CompositeComponent","boundary","_prepare","all","Children","toArray","map","child","__IS_PREPARE__","CHUNKS_KEY","array","withAsyncComponent","load","LoadingComponent","ErrorComponent","AsyncComponent","error","chunkIds","WithAsyncComponent","componentPromise","e","reject","loadPromises","splitComponentLoaders","loader","asyncComponent","default","catch","err","setTimeout","PrepareProvider","preloadChunks","only","childContextTypes","middleware","ctx","next","prepareTyped","preparedTyped","splitTyped","split","excludeTyped","exclude"],"mappings":"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"}